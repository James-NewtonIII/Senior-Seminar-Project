<article>
    <% if notice %>
        <aside id="notice"><%= notice %></aside>
    <% end %>

    <h2>Your Pragmatic Travel Authorization Form</h2>

    <% if true %> <!-- Employee -->
        <table>
            <thead>
                <tr>
                    <th> ID </th>
                    <th> Expense Type </th>
                    <th> Amount </th>
                    <th> Was Approved? </th>
                    <th> Rejection Reason </th>
                    <th></th>
                    <th></th>
                </tr>
            </thead>
            <% @taf.taf_items.each do |taf_item| %>
                <tr>
                    <td><%= taf_item.id %></li>
                    <td> <%= taf_item.expense_type %> </td> 
                    <td> <%= number_to_currency(taf_item.estimated_amount) %> </td>
                    <td> <%= taf_item.ba_approval ? "true" : "false" %> </td>
                    <td> <%= taf_item.ba_reason %> </td>
                
                </tr>
                
                <li style="display:none"><%=@taf.quantity+=1%></li>
                <li style="display:none"><%=@taf.total_estimated_amount+=taf_item.estimated_amount%></li>
                <% end %>
        </table>
            
        <%=@taf.quantity%> | <%=number_to_currency(@taf.total_estimated_amount)%>

    <% elsif true %> <!-- BUDGET APPROVER -->
        <div class="Funds" style="allign-right">
            <table>
                <thead>
                    <th>Department ID</th>
                    <th>Department Name</th>
                    <th>Actual Funds</th>
                    <th>Available Funds</th>
                </thead>
                <% @departments.each do |dept| %>
                        <tr>
                            <td> <%= dept.id %> </td>
                            <td> <%= dept.name %> </td>
                            <td> <%= number_to_currency(dept.available_funds) %> </td>
                            <td> <%= number_to_currency(dept.actual_funds) %> </td>
                        </tr>
                <% end %>
            </table>
        </div>
        <table>
            <thead>
                <tr>
                    <th> ID </th>
                    <th> Expense Type </th>
                    <th> Amount </th>
                    <th> Was Approved? </th>
                    <th> Rejection Reason </th>
                    <th></th>
                    <th></th>
                </tr>
            </thead>
            <% @taf.taf_items.each do |taf_item| %>
                <tr>
                    <td> <%= taf_item.id %> </td> 
                    <td> <%= taf_item.expense_type %> </td> 
                    <td> <%= number_to_currency(taf_item.estimated_amount) %> </td>
                    <td> <%= taf_item.ba_approval ? "true" : "false" %> </td>
                    <td> <%= taf_item.ba_reason %> </td>
                    <td> <%= button_to 'Accept', { :controller => "taf_items",
                                            :action => "decision",
                                            :id => taf_item.id,
                                            :decision => "true"}, method: 'post', class: "btn btn-success" %>
                    </td>
                    <td> <%= button_to 'Reject', { :controller => "taf_items",
                                            :action => "decision",
                                            :id => taf_item.id,
                                            :decision => "false"}, method: 'post', class: "btn btn-danger" %>
                    </td>
                </tr>
            
            <li style="display:none"><%=@taf.quantity+=1%></li>
            <li style="display:none"><%=@taf.total_estimated_amount+=taf_item.estimated_amount%></li>
            <% end %>
        </table>

        <%=@taf.quantity%> | <%=number_to_currency(@taf.total_estimated_amount)%>

    <% elsif true %> <!-- Payment Manager -->
        <div class="pm_top_div">
            <div class="pm_funds_div">
                <table>
                    <thead>
                        <th>Department ID</th>
                        <th>Department Name</th>
                        <th>Actual Funds</th>
                        <th>Available Funds</th>
                    </thead>
                    <% @departments.each do |dept| %>
                        <tr>
                            <td> <%= dept.id %> </td>
                            <td> <%= dept.name %> </td>
                            <td> <%= number_to_currency(dept.available_funds) %> </td>
                            <td> <%= number_to_currency(dept.actual_funds) %> </td>
                        </tr>
                    <% end %>
                </table>
            </div>
            <div class="pm_accept_div">
                <td> <%= button_to 'Accept', { :controller => "tafs",
                                            :action => "decision",
                                            :id => @taf.id,
                                            :decision => "true"}, method: 'post', class: "btn btn-success" %>
                </td>
                <td> <%= button_to 'Reject', { :controller => "tafs",
                                            :action => "decision",
                                            :id => @taf.id,
                                            :decision => "false"}, method: 'post', class: "btn btn-danger" %>
                </td>
            </div>
        </div>
        <table>
            <thead>
                <tr>
                    <th> ID </th>
                    <th> Expense Type </th>
                    <th> Amount </th>
                    <th> Was Approved? </th>
                    <th> Rejection Reason </th>
                    <th></th>
                    <th></th>
                </tr>
            </thead>    
            <% @taf.taf_items.each do |taf_item| %>
                <tr>
                    <td><%= taf_item.id %></li>
                    <td> <%= taf_item.expense_type %> </td> 
                    <td> <%= number_to_currency(taf_item.estimated_amount) %> </td>
                    <td> <%= taf_item.ba_approval ? "true" : "false" %> </td>
                    <td> <%= taf_item.ba_reason %> </td>
                    <li style="display:none"><%=@taf.quantity+=1%></li>
                    <li style="display:none"><%=@taf.total_estimated_amount+=taf_item.estimated_amount%></li>
                </tr>
            <% end %>
        </table>

        <%=@taf.quantity%> | <%=number_to_currency(@taf.total_estimated_amount)%>

    <% else %> <!-- SUPER ACCOUNT -->

    <% end %>
    
    <br>
    <%= link_to 'Edit', edit_taf_path(@taf) %> |
    <%= link_to 'Back', tafs_path %>
</article>